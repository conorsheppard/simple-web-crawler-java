#!/bin/zsh

PROJECT_NAME="simple-web-crawler-java"
JAR_FILE="target/${PROJECT_NAME}-1.0-SNAPSHOT.jar"
MAIN_CLASS="com.conorsheppard.Application"

# Check if Maven build is needed
if [[ ! -f "$JAR_FILE" ]]; then
    echo "Building project with Maven..."
    mvn clean package || { echo "‚ùå Build failed!"; exit 1; }
fi

# Ensure an argument is provided
if [[ $# -ne 1 ]]; then
    echo "Usage: ./crawl <start-url>"
    exit 1
fi

# Run the Java application
echo "üöÄ Running web crawler on $1"
# java -jar "$JAR_FILE" "$MAIN_CLASS" "$1"
mvn exec:java -Dexec.mainClass="$MAIN_CLASS" -Dexec.args="$1"
